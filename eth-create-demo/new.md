å¥½çš„ï¼Œä»¥ä¸‹æ˜¯ä½ é¡¹ç›®ä¸­åŸºäº **Solidity `new` å…³é”®å­—çš„å·¥å‚åˆçº¦éƒ¨ç½²å­åˆçº¦** çš„å®Œæ•´ `README.md`ï¼Œé€‚åˆæ”¾å…¥é¡¹ç›®ä¸­ `factory-new/` å­æ¨¡å—æˆ–ä¸»ä»“åº“çš„ä¸€ä¸ªæ¨¡å—è¯´æ˜ï¼š

---

## âœ… `README.md`ï¼šå·¥å‚åˆçº¦å†…éƒ¨ç”¨ `new` åˆ›å»ºå­åˆçº¦

```markdown
# eth-factory-new-demo

æœ¬æ¨¡å—å±•ç¤ºäº†ä»¥å¤ªåŠåˆçº¦å¦‚ä½•é€šè¿‡ Solidity ä¸­çš„ `new` å…³é”®å­—ï¼Œåœ¨åˆçº¦å†…éƒ¨åŠ¨æ€éƒ¨ç½²å­åˆçº¦ï¼ˆå·¥å‚æ¨¡å¼ï¼‰ã€‚è¿™æ˜¯æœ€å¸¸è§çš„éƒ¨ç½²æ–¹å¼ä¹‹ä¸€ï¼Œé€‚ç”¨äºï¼š

- é’±åŒ…å·¥å‚ï¼ˆæ¯ä¸ªç”¨æˆ·ç‹¬ç«‹å®ä¾‹ï¼‰
- NFT / DAO å·¥å‚
- åˆ›å»ºç‹¬ç«‹é…ç½®çš„åˆçº¦æ± 

---

## ğŸ§± é¡¹ç›®ç»“æ„

```

eth-create-demo/
â”œâ”€â”€ contracts/
â”‚   â”œâ”€â”€ Lock.sol              # å­åˆçº¦ï¼šå¸¦ unlockTime å’Œ withdraw åŠŸèƒ½
â”‚   â””â”€â”€ LockFactory.sol       # å·¥å‚åˆçº¦ï¼šä½¿ç”¨ `new` åŠ¨æ€éƒ¨ç½² Lock
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ deploy-lock-factory.js  # éƒ¨ç½² LockFactory å·¥å‚åˆçº¦
â”‚   â””â”€â”€ create-lock.js          # è°ƒç”¨å·¥å‚åˆ›å»ºæ–°çš„ Lock åˆçº¦

````

---

## âš™ï¸ å®‰è£…ä¾èµ–

```bash
npm install
````

---

## ğŸ”¨ ç¼–è¯‘åˆçº¦

```bash
npx hardhat compile
```

---

## ğŸš€ éƒ¨ç½²æµç¨‹

### ç¬¬ä¸€æ­¥ï¼šéƒ¨ç½² LockFactory å·¥å‚åˆçº¦

```bash
npx hardhat run scripts/deploy-lock-factory.js --network localhost
```

ç¤ºä¾‹è¾“å‡ºï¼š

```
âœ… LockFactory å·²éƒ¨ç½²ï¼š 0x1234abcd...
```

---

### ç¬¬äºŒæ­¥ï¼šä½¿ç”¨å·¥å‚åˆ›å»ºæ–°çš„ Lock åˆçº¦

ä¿®æ”¹ `scripts/create-lock.js` ä¸­çš„åœ°å€ä¸ºä½ ä¸Šä¸€æ­¥éƒ¨ç½²çš„å·¥å‚åœ°å€ï¼š

```js
const factoryAddress = "0x1234abcd..."; // âœ… æ›¿æ¢ä¸ºä½ å®é™…éƒ¨ç½²åœ°å€
```

è¿è¡Œï¼š

```bash
npx hardhat run scripts/create-lock.js --network localhost
```

è¾“å‡ºç¤ºä¾‹ï¼š

```
ğŸš€ è°ƒç”¨å·¥å‚éƒ¨ç½² Lock...
ğŸ‰ Lock åˆçº¦å·²éƒ¨ç½²ï¼š 0x5678efgh...
```

---

## ğŸ” Lock åˆçº¦è¯´æ˜

* æ„é€ å‡½æ•°è¦æ±‚ä¼ å…¥ `unlockTime`ï¼ˆæœªæ¥çš„æ—¶é—´æˆ³ï¼‰
* éƒ¨ç½²æ—¶é™„å¸¦ ETHï¼ˆç¤ºä¾‹ä¸º 0.01ï¼‰
* åˆ°æœŸåéƒ¨ç½²è€…å¯è°ƒç”¨ `withdraw()` æç°

---

## ğŸ“˜ å·¥å‚åˆçº¦è¯´æ˜

```solidity
function createLock(uint unlockTime) external payable returns (address) {
    Lock lock = new Lock{value: msg.value}(unlockTime);
    allLocks.push(address(lock));
    emit LockCreated(address(lock), msg.sender, unlockTime);
    return address(lock);
}
```

è¯¥å‡½æ•°ä¼šï¼š

* ç”¨ `new` å…³é”®å­—éƒ¨ç½²ä¸€ä¸ªæ–°çš„ `Lock` åˆçº¦
* å°†åˆçº¦åœ°å€ä¿å­˜åœ¨æ•°ç»„ä¸­
* è§¦å‘ `LockCreated` äº‹ä»¶

---

## âœ… å·¥å‚æ¨¡å¼å¯¹æ¯”

| æ¨¡å¼        | ä½¿ç”¨æ–¹å¼      | åœ°å€å¯é¢„æµ‹  | åœºæ™¯                      |
| --------- | --------- | ------ | ----------------------- |
| `new`     | å·¥å‚å†…éƒ¨ç›´æ¥è°ƒç”¨  | âŒ ä¸å¯é¢„æµ‹ | é€šç”¨åˆçº¦å®ä¾‹åˆ›å»º                |
| `CREATE2` | ä½¿ç”¨ç› + å­—èŠ‚ç  | âœ… å¯é¢„æµ‹  | é’±åŒ…ã€æ¨¡å—ã€counterfactual éƒ¨ç½² |

---

## ğŸ§ª åç»­å»ºè®®

* [ ] æ·»åŠ  `withdraw-lock.js` è°ƒç”¨éƒ¨ç½²çš„ Lock åˆçº¦ææ¬¾
* [ ] å·¥å‚åˆçº¦ä¸­åŠ å…¥ `mapping` è®°å½•æ¯ä¸ªç”¨æˆ·åˆ›å»ºçš„ Lock
* [ ] å·¥å‚è¿”å›éƒ¨ç½²åœ°å€ä¾›å‰ç«¯æ˜¾ç¤ºæˆ– UI å¯è§†åŒ–è°ƒç”¨
* [ ] è‡ªåŠ¨è®°å½•éƒ¨ç½²å†å²ï¼ˆå¦‚å†™å…¥ deployment.jsonï¼‰

---